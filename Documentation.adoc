:toc: left

:source-highlighter: prettify

// Macro definitions for this file only
:source: Documentation.adoc[Source Text]

include::MainMenu.adoc[]

Please click on the following links to refer the technical documentaion.

.More to Come
NOTE: Please keep checking this section frequently for more updates.
      
== Introduction
The following sections outlines the different options available while configuring an application.

== View Config Annotations

.View Components
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Component | Description |Attributes |Notes

|Page |Used to create a view page | Type - Home,Details,Form,Static |
Default value will be Home.

|Tile |Used to create a view Tile | Size - XSmall,Small,Medium,Large |
Default value will be Large.

|Section |Used to create a view Section. A section is encapsulated in a tile | Size - XSmall,Small,Medium,Large |
Default value will be Large.

|Form |Used to create a view Form to capture user responses. A forn is encapsulated in a section | |


|=========================================================

=== TextBox

.TextBox Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | TextBox |cannot be changed
|hidden |boolean |false |hide/show the component 
|readOnly |boolean |false |make the component readonly 
|help |String | | help
|labelClass |String | anthem-label |class used to style the label 
|type |String | text |type of input 
|postEventOnChange |boolean | false |post the value to the server onblur 
|controlId |String |  |currently not in use except for assessments where this signifies the question number

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.TextBox.java
----
@TextBox(hidden=true) 
private String goalId;
----

TIP: TextBox can be hidden using hidden=true 


=== Tile

.Tile Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | Tile |cannot be changed
|imgSrc |String |  | source path/ url of the image
|title |String | | title
|size |enum | Size.Large | size of the tile

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Tile.java
----
@Tile(size=Tile.Size.Large) 
private TileEditGoal tileEditGoal;
----

NOTE: The possible enum values for size are *XSmall, Small, Medium, Large*


=== Section

.Section Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|value |enum | Type.Default| section type
|alias |String | Section |cannot be changed
|imgSrc |String |  | source path/ url of the image
|cssClass |String | | class used to style the section 
|defaultFlow |String | | flow of the section 

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Section.java
----
@Section
@Path(linked=false)
private SectionEditGoal sectionEditGoal;
----

NOTE: The possible enum values for size are *HEADER, FOOTER, LEFTBAR, RIGHTBAR, BODY, DEFAULT* +
defaultFlow attribute is applicable to section Type.Body only. +
_Please read @Path for more information on @Path._

=== ComboBox

.ComboBox Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | ComboBox |cannot be changed
|readOnly |boolean | false| make the component readonly 
|labelClass |String | anthem-label| class used to style the label 
|postEventOnChange |boolean | false| post the value to the server onblur 
|controlId |String |  |currently not in use except for assessments where this signifies the question number

|=========================================================


[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.ComboBox.java
----
@Path
@Model.Param.Values(url="~/client/orgname/staticCodeValue/_search?fn=lookup&where=staticCodeValue.paramCode.eq('/goalCategory')")
@ComboBox  private String goalCategory;
----

NOTE: @Model annotation will retrieve staticCodeValue collection data from MongoDB.
search is the action that indicates that the data will be searched using
param code _goalCategory_ 


=== InputDate

.InputDate Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | InputDate |cannot be changed
|readOnly |boolean |false |hide/show the component 
|labelClass |String | anthem-label |class used to style the label 
|type |String | date |type of input date
|postEventOnChange |boolean | false |post the value to the server onblur 
|controlId |String |  |currently not in use except for assessments where this signifies the question number

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.InputDate.java
----
@Path
@InputDate private LocalDate startDate;
----


=== Button

.Button Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | Button |cannot be changed
|url |String |  | source url of the button element
|b |String | $execute | b
|method |String | GET | HTTP method that will be executed
|imgSrc |String |  | source path/ url of the image
|type |enum | Type.Plain| type of button 
|payload |String |  | payload
|cssClass |String | btn btn-primary| class used to style the section 
|formReset |boolean |true | reset the form

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Button.java
----
@Config(url="/pageAddEditGoal/tileEditGoal/sectionEditGoal/goalDetailsForm/_nav?pageId=pageCarePlanSummary")
@Button(type = Button.Type.DESTRUCTIVE)
private String delete;
----

NOTE: The possible enum values for size are *PRIMARY, SECONDARY, PLAIN, DESTRUCTIVE* +
_Please read @Config for information regarding @Config annotation._


=== ButtonGroup

.ButtonGroup Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | ButtonGroup |cannot be changed
|cssClass |String | text-sm-right| class used to style the section 

|=========================================================


[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.ButtonGroup.java
----
@ButtonGroup
private FormGoalsButtonGroup formGoalsButtonGroup;
----


=== Form

.Form Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | Form |cannot be changed
|submitUrl |String |  | url that will be hit after submit
|b |String | | b
|cssClass |String | | class used to style the section 
|submitButton |boolean |true | form will be submitted
|navLink |String |  | navigation link

|=========================================================


[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Form.java
----
@Form(cssClass="twoColumn")
@Path(linked=false, state=State.External)
private FormGoalDetails goalDetailsForm;
----


=== Radio

.Radio Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | Radio |cannot be changed
|labelClass |String | anthem-label |class used to style the radio label 
|level |String | 0 |determine the level of radio group
|cssClass |String |  |class used to style the radio 
|postEventOnChange |boolean | false |post the value to the server onblur 
|controlId |String |  |currently not in use except for assessments where this signifies the question number

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Radio.java
----
@Model.Param.Values(url="~/client/orgname/staticCodeValue/_search?fn=lookup&where=staticCodeValue.paramCode.eq('/thisIsParentQuestion14')")
@MapsTo.Path()
@Radio(postEventOnChange=true, controlId = "27")
private String thisIsParentQuestion14;
----

NOTE: *postEventOnChange=true* will override the default false value of postEventOnChange. +
*controlId* is used because in this particular case, there is a question number (27) that the controlId signifies. +
Please refer Core Config Annotations section for @MapsTo


=== CheckBox

.CheckBox Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | CheckBox |cannot be changed
|cssClass |String |  |class used to style the CheckBox 
|labelClass |String | anthem-label |class used to style the CheckBox label 
|postEventOnChange |boolean | false |post the value to the server onblur 
|controlId |String |  |currently not in use except for assessments where this signifies the question number

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.CheckBox.java
----
@CheckBox(postEventOnChange=true)
private boolean admin;
----

NOTE: *postEventOnChange=true* will override the default false value of postEventOnChange.


=== MultiSelectCard

.MultiSelectCard Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | MultiSelectCard |cannot be changed

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.MultiSelectCard.java
----
@MultiSelectCard @NotNull  
@Model.Param.Values(url="~/client/orgname/cmprogram/_search?fn=lookup&projection.mapsTo=code:id,label:programName")
@Path(value="/programReferred", colElemPath="/programName")
private List<String> cmProgramList;
----

NOTE: @NotNull indicates that the component cannot be null.

=== PickList

.PickList Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | PickList |cannot be changed
|labelClass |String | anthem-label |class used to style the picklist label 
|readOnly |boolean |false | make the component readonly 
|cssClass |String |  |class used to style the picklist 
|postEventOnChange |boolean | false |post the value to the server onblur 
|sourceHeader |String | SourceList | specify the source header for the picklist
|targetHeader |String | TargetList | specify the target header for the picklist

|=========================================================


=== Grid

.Grid Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | Grid |cannot be changed
|onLoad |boolean |false | specify the behaviour of CardDetailsGrid during page load
|isTransient |boolean |false | specify the behaviour of CardDetailsGrid during page load
|url |String |  |specify url for the Grid 
|rowSelection |boolean |false | determine if row selection is enabled on the Grid
|pageSize |String | 10 |specify the page size for the Grid 
|pagination |boolean |true | determine if pagination is enabled on the Grid
|postButton |boolean |false | determine if post Button is enabled on the Grid
|postButtonUrl |String |  |specify the url of post button for the Grid
|postEventOnChange |boolean | false |post the value to the server onblur 

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Grid.java
----
@Grid
@MapsTo.Path(linked=false,state=State.External)
private List<SearchPatient> patientResult;	
----

NOTE: Please refer Core Config Annotations section for @MapsTo


=== Page

.Page Attributes
[width="80%",cols="3,^2,^2,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | page |cannot be changed
|type |enum | Type.Home| page type
|route |String |  | specify route of the page
|layout |String | | specify layout of the page 
|breadCrumb |String | none | specify breadCrumb of the page 
|imgSrc |String |  | source path/ url of the image
|styleClass |String | | class used to style the section 
|defaultPage |boolean | false | determine if the page will be the default page

|=========================================================

NOTE: The possible enum values for type are *HOME, DETAILS, FORM, STATIC*

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Page.java
----
@Page(route="cmcaseR/assignmenttaskview", defaultPage=true, layout="caseoverviewlayout")
private Page_AssignmentTask pageAssignmentTask;
----

NOTE: *defaultPage=true* will override the default false value of defaultPage.



=== CardDetail

.CardDetail Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | CardDetail |cannot be changed
|cssClass |String | contentBox right-gutter bg-light mt-1 |class used to style the CardDetail 
|imgSrc |String |  | source path/ url of the image
|editable |boolean |false | make the component editable 
|modelPath |String |  |specify the model path for CardDetail
|title |String |  | specify the title of the CardDetail
|draggable |boolean |false | determine of the CardDetailsGrid is draggable 

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.CardDetail.java
----
@CardDetail(title="Member Overview", cssClass="contentBox right-gutter bg-alternate mt-0")
private CardDetailMember cardDetailMember;
----

NOTE: *contentBox right-gutter bg-alternate mt-0* overrides the default cssClass specified for the CardDetail


=== CardDetailsGrid

.CardDetailsGrid Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | CardDetailsGrid |cannot be changed
|editUrl |String |  | 
|draggable |boolean |false | determine of the CardDetailsGrid is draggable
|onLoad |boolean |false | specify the behaviour of CardDetailsGrid during page load

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.CardDetailsGrid.java
----
@CardDetailsGrid(onLoad=true, draggable=true)
@Config(url="/pageHealthConcerns/tileHealthConcerns/sectionConcerns/concernsCards.m/_process?fn=_set&url=/p/cmcase/_search?fn=query&where=cmcase.id.eq('<!/.m/id!>')&project=/healthProblemsEnclosed")
@Path(linked=false)
private List<CardDetailConcerns> concernsCards;
----

NOTE: *onLoad=true* and *draggable=true* will override the default false values for onLoad and draggable respectively. +
_For information regarding @Config, please read View Configuration Annotations section_


=== Domain

_@Domain component is a part of view config as well as core config annotations._ 
The difference between the two is that @Domain annotation of view config does not persist any data
while @Domain annotation of core config persists data in MongoDB. +

View configuration @Domain annotation does not persist any data.
*value=Database.rep_none* specifies that a class with @Domain annotation does 
not persist any data in database. +

For information about @Domain in core config, please refer to Core Config
Annotations section.

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Domain.java
----
@Domain(value = "cmcaseview",includeListeners={ListenerType.websocket})
@MapsTo.Type(CMCase.class)
@Repo(value=Database.rep_none, cache=Cache.rep_device)
@Getter @Setter
public class VRCmCase {
}
----



== Core Config Annotations

=== Domain

Config configuration @Domain annotation persists data. 

*includeListeners={ListenerType.persistence, ListenerType.update}*
specifies that the data will be persisted. +
*value=Database.rep_mongodb* specifies that a class with
@Domain annotation will use MongoDb for persistence.

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Domain.java
----
@Domain(value="cmcase", includeListeners={ListenerType.persistence, ListenerType.update}) 
@Repo(value=Database.rep_mongodb, cache=Cache.rep_device)
public class CMCase extends IdString {
}
----

NOTE: Please read @Repo for mroe information regarding @Repo annotation.


=== Repo

.Repo Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|alias |String | | cannot be changed
|value |enum |  |specify value of Path
|cache |enum | Cache.rep_device | specifies cache type
|autoSave |boolean |true | determine if the autosave is enabled

|=========================================================

NOTE: The possible enum values for value are *DATABASE.rep_none, DATABASE.rep_rdbms, DATABASE.rep_mongodb* +
The possible enum values for cache are *CACHE.rep_none, CACHE.rep_device* 

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Repo.java
----
@Domain(value="cmassessment", includeListeners={ListenerType.persistence})
@Repo(alias="cmassessment",value=Database.rep_mongodb, cache=Cache.rep_device)
@Getter @Setter
public class CMAssessment extends IdString {
}
----


=== Config

.Config Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|url |String |  | 

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Config.java
----
@Config(url="~/client/org_name/_nav?pageId=pageCarePlanSummary")
@Button(type = Button.Type.PLAIN)
private String cancel;
----

A class with @Config annotation is used to perform an action on button click.
In most cases, the action is to retrieve values via HTTP Rest calls
from database (MongoDB), and display on the web page. +

In the example shown above, _nav_ is the http call for navigation. +
The possible Actions are: - +

 - get for HTTP GET
 - new for HTTP post
 - update for HTTP update
 - delete for HTTP delete
 - search for searching
 - nav for navigation
 - process for custom process/ work-flow definitions


==== Configs

.Configs Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|values |Config[] |  | 

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Configs.java
----
@Configs({
@Config(url="~/client/org_name/_update"),
@Config(url="~/client/org_name/_process?fn=_set&url=/p/cmcase/_search?fn=query&where=cmcase.patientReferred.firstName.eq('<!/.m/patientReferred/firstName!>').and(cmcase.patientReferred.lastName.eq('<!/.m/patientReferred/lastName!>'))"),
@Config(url="~/client/org_name/_nav?pageId=vpAdvancedCaseSearch")
		})
@Button(type=Button.Type.PRIMARY, formReset=false)
private String submit;
----

@Configs is a collection of configuration calls. Multiple calls to the database
can be made using @Configs, where each call will be represented by @Config. +

As shown in the example, when the submit button is clicked, three http calls that are being made viz. 
update, process, and navigation.


=== MapsTo

==== Path

.Path Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|value |String |  |specify value of Path
|colElemPath |String | DEFAULT_COL_ELEM_PATH | specifies column element path
|state |State | State.Internal | specifie path state 
|linked |boolean |true | determine if the path has links
|cache |Cache | Cache.rep_device | specifies cache type

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Path.java
----
@Path()
private Long version;
----


==== Type

.Type Attributes
[width="80%",cols="4,^3,^3,10",options="header"]
|=========================================================
|Name | Type |Default |Description

|value |class<?> | | 
|silent |boolean | true |determines if Type is silent

|=========================================================

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Type.java
----
@MapsTo.Type(CMCase.class)
public static class SectionEditGoal  {
    }
----

NOTE: If it is not mapped _(@Mapped)_, an exception will be thrown. +
If no exception is thrown, defaults to silent.



== Layout Configuration



As you can see in the screenshot above, the layout of the application is 
divided into 3 sections viz. Header, Footer, and Leftbar. Please read the code
below to understand the way the sections has been created.

[[app-listing]]
[source,java,indent=0]
[subs="verbatim,attributes"]
.Repo.java
----
public static class VPHome {
		
@Section(Type.HEADER) 
private VSHomeHeader vsHomeHeader;
		
@Section(Type.LEFTBAR) 
private VSHomeLeftBar vsHomeLeftBar;

@Section(Type.FOOTER) 
private VSHomeFooter vsHomeFooter;

	}
----

NOTE: @Section(Type.*_value_*) determines the section on the page. This code shows 
three of the _type_ values for @Section. For more values, please refer to the @Section
annotation within View Config Annotations.


== Rule Configuration

.Framework comes with support for Drools Rules (https://www.drools.org/) engine out of the box. The rules can be defined at multiple levels.
* Entity Level: Rules defined at the entity level gets triggered everytime the entity is updated. Typically business rules that manage the entity state would be defined at this level. The framework would pick any rule with the extension <domainalias>.drl and associate with the entity updates. The rule would have access to the entity domain that it is being executed. 
* Function Handler: Business rules that can span across multiple entities or needs to be controlled based on business flow rather than everytime entity is updated can be configured using Function handler. Please refer to the Function Hanlder documentation for more information on configuring these rules.

== Process Configuration

=== Business Process Configuration
include::BPMConfiguration.adoc[]

=== Framework Function Handlers
Standard function handlers can be invoke with *_process* action. Example *@Config(url="/p/patient:<!/.m/id!>/_process?fn=_set")*

. The fremwork provides the following function handlers out of the box
* _set: Sets parameter value.
* _bpm: Invokes a statless bpm process.
* _add: Adds parameter value to a collection.
* _setByRule: Set parameter value through a rule.

=== Creating Custom Function Handlers
The framework provides the ability to users to define custom function handlers.



include::Querydsl.adoc[]

=== View Configuration
include::ViewConfiguration.adoc[]

== Infrastructure
image::application-setup.jpeg[Infrastructure]


